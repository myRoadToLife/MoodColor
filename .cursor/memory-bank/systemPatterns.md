# Системные Паттерны MoodColor

## Системная Архитектура
MoodColor следует модульной архитектуре с внедрением зависимостей (DI) для обеспечения слабой связи между компонентами. Этот подход облегчает тестирование, поддержку и будущее расширение приложения.

### Основные Архитектурные Компоненты

#### Точка Входа (EntryPoint.cs)
EntryPoint служит центром инициализации приложения, где все сервисы регистрируются в контейнере DI. Он отвечает за:
- Инициализацию базовых настроек приложения
- Настройку и запуск системы внедрения зависимостей
- Инициализацию Firebase (Auth, Database)
- Регистрацию основных сервисов и запуск Bootstrap-процесса
- Обеспечение корректного порядка инициализации компонентов

#### Слой Сервисов
Сервисы инкапсулируют основную бизнес-логику и функциональность, следуя принципу единственной ответственности:
- **Сервис Аутентификации**: Управляет аутентификацией пользователей через Firebase
- **Сервис Эмоций (EmotionService)**: Реализует ключевую логику отслеживания и анализа эмоций
- **Сервис Базы Данных**: Отвечает за хранение и синхронизацию данных с облаком
- **Сервис Управления Сценами**: Контролирует навигацию между сценами приложения
- **Сервис Социальных Взаимодействий**: Поддерживает социальные функции через Firebase
- **Сервис Загрузочного Экрана**: Обеспечивает плавную загрузку и переходы

#### Слой UI
Реализация пользовательского интерфейса отделена от бизнес-логики:
- **PanelManager**: Централизованное управление UI-панелями
- **Компоненты UI**: Модульные элементы для различных экранов приложения
- **Экраны**: Основные представления приложения (Auth, PersonalArea)

## Паттерны Проектирования

### Внедрение Зависимостей (DIContainer)
Собственная реализация контейнера зависимостей для регистрации и разрешения сервисов. Поддерживает:
- Регистрацию синглтонов
- Регистрацию через фабричные методы
- Отложенную (Lazy) и немедленную (NonLazy) инициализацию
- Инжекцию зависимостей в компоненты

### Паттерн Bootstrap
Реализован через Bootstrap.cs, который отвечает за последовательный запуск приложения после инициализации всех сервисов.

### Паттерн Сервис
Все основные функции инкапсулированы в сервисах, которые имеют четко определенные интерфейсы и доступны через контейнер DI.

### Паттерн Наблюдатель (Observer)
Используется в EmotionService и других компонентах для обеспечения реактивных обновлений UI.

### Паттерн Фабрика
Применяется в MonoFactory для создания компонентов Unity с поддержкой внедрения зависимостей.

### Паттерн Репозиторий
Используется для работы с данными, особенно в интеграции с Firebase Database.

## Взаимосвязи Компонентов
- **EntryPoint → DIContainer**: Инициализирует и конфигурирует контейнер DI
- **DIContainer → Сервисы**: Разрешает зависимости между сервисами
- **Bootstrap → Сцены**: Управляет загрузкой начальных сцен приложения
- **Сервисы → UI**: Предоставляют данные и функциональность для UI-компонентов
- **Firebase → Сервисы**: Обеспечивает облачную синхронизацию и аутентификацию

## Поток Данных
1. Пользователь взаимодействует с элементами UI
2. UI-компоненты вызывают методы соответствующих сервисов
3. Сервисы выполняют бизнес-логику и взаимодействуют с хранилищем данных
4. Данные синхронизируются с Firebase при наличии соединения
5. Изменения отображаются в UI через систему обновлений

## Структура Ключевых Компонентов
- **EmotionService**: Ядро приложения, управляющее логикой эмоций
- **EmotionHistory**: Отвечает за историю эмоциональных состояний
- **EmotionMixingRules**: Определяет правила взаимодействия различных эмоций
- **EmotionStatistics**: Анализирует паттерны эмоций пользователя

Эта архитектура обеспечивает модульность, тестируемость и удобство сопровождения, предоставляя прочную основу для будущего расширения. 