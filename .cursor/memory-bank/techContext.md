# Технический Контекст MoodColor

## Платформа Разработки
- **Unity Engine**: Основная платформа разработки для кроссплатформенной совместимости
- **Версия Unity**: 2022.3.62f1 LTS
- **IDE**: JetBrains Rider 2025.1 с интеграцией Unity
- **Контроль Версий**: Git с репозиторием GitHub
- **Управление Ассетами**: Unity Addressables для динамической загрузки ресурсов

## Программирование
- **Язык**: C# 
- **Стиль Кода**: Следование лучшим практикам Unity с PascalCase для публичных членов, _camelCase для приватных членов
- **Документация**: XML-документация для публичных API и ключевых компонентов
- **Тестирование**: Модульные тесты с NUnit для основной бизнес-логики
- **Логирование**: Собственная система MyLogger с категориями для детальной диагностики

## Архитектура и Фреймворки
- **Внедрение Зависимостей**: Собственный легковесный контейнер DI (DIContainer) с поддержкой циклических зависимостей
- **UI Фреймворк**: Система UI Unity с TextMeshPro для рендеринга текста, PanelManager для управления UI
- **Управление Сценами**: Кастомная система управления сценами с Bootstrap-процессом
- **Сохранение Данных**: SecurePlayerPrefs для шифрованного хранения локальных данных, FirebaseDatabase для облачного хранения
- **Управление Состоянием**: EmotionService для основной логики приложения с полной Firebase интеграцией
- **Паттерны**: Facade (FirebaseServiceFacade), Observer, Repository, Factory

## Облачные Интеграции
- **Firebase**: 
  - Аутентификация пользователей (FirebaseAuth) с поддержкой Google Sign-In
  - Облачная база данных (FirebaseDatabase) с оптимизированными запросами
  - Аналитика и отчеты о сбоях (Crashlytics)
  - Push-уведомления (Firebase Messaging)
  - Удаленная конфигурация (Remote Config)
- **Социальные функции**: Интегрированные через FirebaseSocialService с поиском друзей
- **Синхронизация**: Надежная синхронизация данных с обработкой конфликтов

## Мобильная Интеграция
- **Целевые Платформы**: Android и iOS 
- **Минимальные Спецификации**:
  - Android 7.0+ (уровень API 24)
  - iOS 14.0+
- **Разрешения Экрана**: Поддержка различных соотношений сторон и разрешений
- **Возможности Устройства**: Доступ к камере (опционально), локальное хранилище, push-уведомления
- **Сборка**: Готовые APK файлы для тестирования

## Соображения Производительности
- **Целевая Частота Кадров**: 60 кадров/с (явно установлено в EntryPoint)
- **Использование Памяти**: <100МБ для основной функциональности
- **Влияние на Батарею**: Оптимизировано для минимизации расхода батареи
- **Оптимизация Ресурсов**: Сжатие текстур, оптимизация моделей и производительность шейдеров
- **Кэширование**: EmotionHistoryCache для оптимизации работы с историей эмоций
- **Батчинг**: Пакетные операции для Firebase запросов

## Технические Ограничения
- **Офлайн-Функциональность**: Поддерживается через локальное хранение и синхронизацию с Firebase
- **Безопасность Данных**: Защищенное хранение с использованием SecurePlayerPrefs и FirebaseAuth
- **Использование Батареи**: Минимизация фоновой обработки
- **Хранилище**: Эффективное хранение данных для минимизации размера приложения
- **Время Загрузки**: Реализован загрузочный экран (LoadingScreen) для улучшения UX

## Система Эмоций
- **Типы Эмоций**: 11 типов (Joy, Sadness, Anger, Fear, Disgust, Trust, Anticipation, Surprise, Love, Anxiety, Neutral)
- **Смешивание**: EmotionMixingRules для комбинирования эмоций
- **Аналитика**: Статистика по времени суток, частота логирования, паттерны эмоций
- **Конфигурация**: EmotionConfigService с Addressables для загрузки конфигураций

## Игровые Механики
- **Система Очков**: PointsService с различными источниками очков
- **Уровни**: LevelSystem с опытом и прогрессией
- **Достижения**: AchievementService для мотивации пользователей
- **Социальные Функции**: Друзья, поиск пользователей, социальная активность

## Зависимости
- **Внешние SDK**:
  - Firebase SDK (Auth, Database, Analytics, Crashlytics, Messaging, RemoteConfig)
  - Google Play Services для Android
  - Social SDK для интеграции с социальными сетями
- **Unity Packages**:
  - Addressables для управления ассетами
  - TextMeshPro для рендеринга текста
  - Universal Render Pipeline (URP)
- **Зависимости от Ресурсов**:
  - Пользовательские шейдеры для цветовых эффектов
  - Конфигурационные файлы эмоций

## Рабочий Процесс Разработки
- **CI/CD**: Автоматизированные сборки через Unity Cloud Build или аналог
- **Обеспечение Качества**: Ручное тестирование на различных устройствах, автоматизированные тесты для основной логики
- **Процесс Релиза**: Внутреннее тестирование, затем поэтапный выпуск в продакшн
- **Версионирование**: Семантическое версионирование (MAJOR.MINOR.PATCH)
- **Отладка**: Детальная система логирования с категориями для диагностики проблем

## Решенные Технические Проблемы
- **Firebase Синхронизация**: Решены проблемы с дублированием записей и неправильными запросами
- **Security Rules**: Настроены корректные правила доступа к данным
- **DI Container**: Стабильная работа с поддержкой сложных зависимостей
- **Кэширование**: Оптимизированное кэширование для улучшения производительности 